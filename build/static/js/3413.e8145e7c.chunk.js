"use strict";(self.webpackChunkmy_rsk_wallet_app=self.webpackChunkmy_rsk_wallet_app||[]).push([[3413],{317:(t,e,i)=>{function n(t){return"string"===typeof t?Number.parseInt(t,"0x"===t.trim().substring(0,2)?16:10):"bigint"===typeof t?Number(t):t}i.d(e,{n:()=>n})},33413:(t,e,i)=>{i.d(e,{PaperWalletConnector:()=>c});var n=i(1996),s=i(21120),o=i(39917),r=i(317),a=i(25571),h=i(75781);i(37380);class c extends h.C{constructor(t){super(),(0,n._)(this,"id",a.w.paper),(0,n._)(this,"name","Paper Wallet"),(0,n._)(this,"ready",!0),(0,n._)(this,"user",null),(0,n._)(this,"onAccountsChanged",(async t=>{0===t.length?await this.onDisconnect():this.emit("change",{account:o.getAddress(t[0])})})),(0,n._)(this,"onChainChanged",(t=>{const e=(0,r.n)(t),i=-1===this.options.chains.findIndex((t=>t.chainId===e));this.emit("change",{chain:{id:e,unsupported:i}})})),(0,n._)(this,"onDisconnect",(async()=>{this.emit("disconnect")})),this.options=t}getPaperSDK(){return this.paper||(this.paper=new Promise((async(t,e)=>{var n;const o=null===(n=this.options.advancedOptions)||void 0===n?void 0:n.recoveryShareManagement;try{const{PaperEmbeddedWalletSdk:e}=await Promise.resolve().then(i.bind(i,21120)),n={AWS_MANAGED:s.Q.AWS_MANAGED,USER_MANAGED:s.Q.USER_MANAGED};t(new e({advancedOptions:{recoveryShareManagement:o?n[o]:void 0},clientId:this.options.clientId,chain:"Ethereum",styles:this.options.styles,onAuthSuccess:this.options.onAuthSuccess}))}catch(r){e(r)}}))),this.paper}async connect(t){const e=await this.getPaperSDK();if(!e)throw new Error("Paper SDK not initialized");const i=await e.getUser();switch(i.status){case s._O.LOGGED_OUT:{let i;if(null!==t&&void 0!==t&&t.googleLogin){const n=t.googleLogin;i=await e.auth.loginWithGoogle("object"===typeof n?n:void 0)}else i=null!==t&&void 0!==t&&t.email&&null!==t&&void 0!==t&&t.otp?await e.auth.verifyPaperEmailLoginOtp({email:t.email,otp:t.otp,recoveryCode:t.recoveryCode}):null!==t&&void 0!==t&&t.email?await e.auth.loginWithPaperEmailOtp({email:t.email}):await e.auth.loginWithPaperModal();this.user=i.user;break}case s._O.LOGGED_IN_WALLET_INITIALIZED:"object"===typeof(null===t||void 0===t?void 0:t.googleLogin)&&t.googleLogin.closeOpenedWindow&&t.googleLogin.openedWindow&&t.googleLogin.closeOpenedWindow(t.googleLogin.openedWindow),this.user=i}if(!this.user)throw new Error("Error connecting User");return null!==t&&void 0!==t&&t.chainId&&this.switchChain(t.chainId),this.setupListeners(),this.getAddress()}async disconnect(){const t=await this.paper;await(null===t||void 0===t?void 0:t.auth.logout()),this._signer=void 0,this.user=null}async getAddress(){return(await this.getSigner()).getAddress()}async isConnected(){try{return!!await this.getAddress()}catch(t){return!1}}async getProvider(){const t=await this.getSigner();if(!t.provider)throw new Error("Provider not found");return t.provider}async getSigner(){var t;if(this._signer)return this._signer;if(!this.user){const t=await this.getPaperSDK(),e=await t.getUser();if(e.status===s._O.LOGGED_IN_WALLET_INITIALIZED)this.user=e}const e=await(null===(t=this.user)||void 0===t?void 0:t.wallet.getEthersJsSigner({rpcEndpoint:this.options.chain.rpc[0]||""}));if(!e)throw new Error("Signer not found");return this._signer=e,e}async isAuthorized(){return!1}async switchChain(t){var e,i;const n=this.options.chains.find((e=>e.chainId===t));if(!n)throw new Error("Chain not configured");await(null===(e=this.user)||void 0===e?void 0:e.wallet.setChain({chain:"Ethereum"})),this._signer=await(null===(i=this.user)||void 0===i?void 0:i.wallet.getEthersJsSigner({rpcEndpoint:n.rpc[0]||""})),this.emit("change",{chain:{id:t,unsupported:!1}})}async setupListeners(){const t=await this.getProvider();t.on&&(t.on("accountsChanged",this.onAccountsChanged),t.on("chainChanged",this.onChainChanged),t.on("disconnect",this.onDisconnect))}updateChains(t){this.options.chains=t}async getEmail(){if(await this.getProvider(),!this.user)throw new Error("No user found, Paper Wallet is not connected");return this.user.authDetails.email}}}}]);
//# sourceMappingURL=3413.e8145e7c.chunk.js.map