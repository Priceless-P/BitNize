"use strict";(self.webpackChunkmy_rsk_wallet_app=self.webpackChunkmy_rsk_wallet_app||[]).push([[8032],{26613:(t,e,r)=>{r.d(e,{C:()=>a});class a{constructor(t){this.contractWrapper=t}overrideNextTransaction(t){this.contractWrapper.withTransactionOverride(t)}}},37225:(t,e,r)=>{r.d(e,{C:()=>p});var a=r(10939),s=r(9720),o=r(38285),n=r(47177),i=r(78800),c=r(31363);class p{constructor(t,e){(0,a.A)(this,"featureName",o.d4.name),(0,a.A)(this,"setAll",(0,i.f)((async(t,e)=>{const r=e||await this.contractWrapper.getSignerAddress(),a=new c.C(this.contractWrapper),n=Object.keys(t);(0,s.A)(n.length,"you must provide at least one role to set"),(0,s.A)(n.every((t=>this.roles.includes(t))),"this contract does not support the given role");const p=await this.getAll(),l=[],h=n.sort((t=>"admin"===t?1:-1));for(let s=0;s<h.length;s++){var d,m;const e=h[s],[n,i]=await Promise.all([Promise.all((null===(d=t[e])||void 0===d?void 0:d.map((t=>(0,o.aL)(t))))||[]),Promise.all((null===(m=p[e])||void 0===m?void 0:m.map((t=>(0,o.aL)(t))))||[])]),c=n.filter((t=>!i.includes(t))),u=i.filter((t=>!n.includes(t)));if(u.length>1){const t=u.indexOf(r);t>-1&&(u.splice(t,1),u.push(r))}if(c.length&&c.forEach((t=>{l.push(a.encode("grantRole",[(0,o.H)(e),t]))})),u.length){(await Promise.all(u.map((t=>this.getRevokeRoleFunctionName(t))))).forEach(((t,r)=>l.push(a.encode(t,[(0,o.H)(e),u[r]]))))}}return i.T.fromContractWrapper({contractWrapper:this.contractWrapper,method:"multicall",args:[l]})}))),(0,a.A)(this,"grant",(0,i.f)((async(t,e)=>{(0,s.A)(this.roles.includes(t),'this contract does not support the "'.concat(t,'" role'));const r=await(0,o.aL)(e);return i.T.fromContractWrapper({contractWrapper:this.contractWrapper,method:"grantRole",args:[(0,o.H)(t),r]})}))),(0,a.A)(this,"revoke",(0,i.f)((async(t,e)=>{(0,s.A)(this.roles.includes(t),'this contract does not support the "'.concat(t,'" role'));const r=await(0,o.aL)(e),a=await this.getRevokeRoleFunctionName(r);return i.T.fromContractWrapper({contractWrapper:this.contractWrapper,method:a,args:[(0,o.H)(t),r]})}))),this.contractWrapper=t,this.roles=e}async getAll(){(0,s.A)(this.roles.length,"this contract has no support for roles");const t={},e=Object.entries(this.roles);return(await Promise.all(e.map((t=>{let[,e]=t;return this.get(e)})))).forEach(((r,a)=>t[e[a][1]]=r)),t}async get(t){(0,s.A)(this.roles.includes(t),'this contract does not support the "'.concat(t,'" role'));const e=this.contractWrapper;if((0,n.h)("getRoleMemberCount",e)&&(0,n.h)("getRoleMember",e)){const r=(0,o.H)(t),a=(await e.read("getRoleMemberCount",[r])).toNumber();return await Promise.all(Array.from(Array(a).keys()).map((t=>e.read("getRoleMember",[r,t]))))}throw new Error("Contract does not support enumerating roles. Please implement IPermissionsEnumerable to unlock this functionality.")}async verify(t,e){await Promise.all(t.map((async t=>{const[r,a]=await Promise.all([this.get(t),(0,o.aL)(e)]);if(!r.map((t=>t.toLowerCase())).includes(a.toLowerCase()))throw new o.o(a,t)})))}async getRevokeRoleFunctionName(t){const[e,r]=await Promise.all([(0,o.aL)(t),this.contractWrapper.getSignerAddress()]);return r.toLowerCase()===e.toLowerCase()?"renounceRole":"revokeRole"}}},18032:(t,e,r)=>{r.r(e),r.d(e,{Split:()=>d});var a=r(10939),s=r(38378),o=r(1748),n=r(31363),i=r(38285),c=r(78800),p=r(47177),l=r(26613),h=r(37225);r(80611),r(95220),r(59863);class d{get chainId(){return this._chainId}constructor(t,e,r){(0,a.A)(this,"withdraw",(0,c.f)((async t=>c.T.fromContractWrapper({contractWrapper:this.contractWrapper,method:"release(address)",args:[await(0,i.aL)(t)]})))),(0,a.A)(this,"withdrawToken",(0,c.f)((async(t,e)=>c.T.fromContractWrapper({contractWrapper:this.contractWrapper,method:"release(address,address)",args:await Promise.all([(0,i.aL)(e),(0,i.aL)(t)])})))),(0,a.A)(this,"distribute",(0,c.f)((async()=>c.T.fromContractWrapper({contractWrapper:this.contractWrapper,method:"distribute()",args:[]})))),(0,a.A)(this,"distributeToken",(0,c.f)((async t=>c.T.fromContractWrapper({contractWrapper:this.contractWrapper,method:"distribute(address)",args:[await(0,i.aL)(t)]}))));let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4?arguments[4]:void 0,m=arguments.length>5?arguments[5]:void 0,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:new i.cs(t,e,o,s,r);this._chainId=m,this.abi=i.bj.parse(o||[]),this.contractWrapper=u,this.storage=r,this.metadata=new p.C(this.contractWrapper,i.c7,this.storage),this.app=new p.b(this.contractWrapper,this.metadata,this.storage),this.roles=new h.C(this.contractWrapper,d.contractRoles),this.encoder=new n.C(this.contractWrapper),this.estimator=new p.G(this.contractWrapper),this.events=new p.a(this.contractWrapper),this.interceptor=new l.C(this.contractWrapper)}onNetworkUpdated(t){this.contractWrapper.updateSignerOrProvider(t)}getAddress(){return this.contractWrapper.address}async getAllRecipients(){const t=[];let e=s.gH.from(0);const r=await this.contractWrapper.read("payeeCount",[]);for(;e.lt(r);)try{const r=await this.contractWrapper.read("payee",[e]);t.push(await this.getRecipientSplitPercentage(r)),e=e.add(1)}catch(a){if("method"in a&&a.method.toLowerCase().includes("payee(uint256)"))break;throw a}return t}async balanceOfAllRecipients(){const t=await this.getAllRecipients(),e={};for(const r of t)e[r.address]=await this.balanceOf(r.address);return e}async balanceOfTokenAllRecipients(t){const[e,r]=await Promise.all([(0,i.aL)(t),this.getAllRecipients()]),a={};for(const s of r)a[s.address]=await this.balanceOfToken(s.address,e);return a}async balanceOf(t){const[e,r,a]=await Promise.all([(0,i.aL)(t),this.contractWrapper.getProvider().getBalance(this.getAddress()),this.contractWrapper.read("totalReleased",[])]),s=r.add(a);return this._pendingPayment(e,s,await this.contractWrapper.read("released",[e]))}async balanceOfToken(t,e){const[a,s]=await Promise.all([(0,i.aL)(e),(0,i.aL)(t)]),c=(await Promise.resolve().then(r.t.bind(r,96337,19))).default,p=new o.NZ(a,c,this.contractWrapper.getProvider()),[l,h,d]=await Promise.all([p.balanceOf(this.getAddress()),this.contractWrapper.read("totalReleased",[a]),this.contractWrapper.read("released",[a,s])]),m=l.add(h),u=await this._pendingPayment(s,m,d);return await(0,n.a)(this.contractWrapper.getProvider(),a,u)}async getRecipientSplitPercentage(t){const[e,r,a]=await Promise.all([(0,i.aL)(t),this.contractWrapper.read("totalShares",[]),this.contractWrapper.read("shares",[t])]);return{address:e,splitPercentage:a.mul(s.gH.from(1e7)).div(r).toNumber()/1e5}}async _pendingPayment(t,e,r){const[a,s]=await Promise.all([(0,i.aL)(t),this.contractWrapper.read("totalShares",[])]);return e.mul(await this.contractWrapper.read("shares",[a])).div(s).sub(r)}async prepare(t,e,r){return c.T.fromContractWrapper({contractWrapper:this.contractWrapper,method:t,args:e,overrides:r})}async call(t,e,r){return this.contractWrapper.call(t,e,r)}}(0,a.A)(d,"contractRoles",i.dM)}}]);
//# sourceMappingURL=8032.e91b2c4a.chunk.js.map